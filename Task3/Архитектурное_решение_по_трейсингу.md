1. Проанализируйте систему компании и C4-диаграмму в контексте планирования трейсинга

Трейсинг нужен там, где идет взаимодействие компонентов типа "Приложение", "API", "RMQ", "DB"
- Shop API → Shop DB
- Internet Shop → Shop API
- CRM → CRM API → Shop DB / RMQ
- CRM API ↔ RMQ ↔ MES API
- MES API → MES DB
- MES API → 3D Files Storage

2. Мотивация
- Диагностика проблем в распределённых системах.
  В архитектуре с множеством API и RMQ, трейсинг помогает понять, где именно происходит сбой или задержка.
- Повышение скорости отладки.
  Вместо сбора логов с разных сервисов — одна цепочка событий в Grafana.
- End-to-end видимость.
- Снижение потерь из-за ошибок. Пропущенные заказы или зависшие сообщения в RMQ = прямые убытки.
- Поддержка SLA и аудит. Возможность демонстрировать стабильность и надёжность системы для внешних клиентов.

3. Предполагаемое решение

[Предполагаемое решение](Предлагаемое_решение.drawio)

Компоненты, которые следует добавить на схему:
- OpenTelemetry SDK в каждый бэкенд сервис
- OTEL Collector будет консолидировать все трассировки
- Jaeger + ElasticSearch для хранения и визуализации трассировок

4. Компромиссы
- Каждое создание и экспорт спанов — это небольшая, но всё же нагрузка (CPU, сеть). 
  При большом потоке — может быть ощутимо. Если сервер слабый, можно временно обойтись без трейсинга
- OpenTelemetry требует настройки в каждом сервисе. 
  Надо следить за контекстом, поддерживать совместимость форматов и прокидывание trace-id.
  Если в команде мало людей, это может стать проблемой для сопровождения.
- Нет RMQ. Если взаимодействие синхронное, можно обойтись логами + метриками.
- Сервис не критичен или не участвует в ключевых цепочках.

5. Безопасность
- Использовать учетные записи, зарегестрированные через корпоративную почту.
- Выставить систему ролей для тех, кто может видеть трейсы (Поддержка, Dev Ops, etc)
- Делить трейсы разных бэкендов на группы, чтобы ограничить видимость для пользователей, которые не имеют отношения 
  к определенным сервисам.
- Настроить корпоративный VPN
- Исключить попадание чувствительных данных в трейсы
- Хранить сикреты от Jaeger в защищенных местах, типа Vault


