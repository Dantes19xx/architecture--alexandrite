Проанализируйте систему компании и C4-диаграмму в контексте планирования логирования. 
Опишите, какие логи нужно собирать и отметьте на схеме, из каких систем требуется сбор логов. 
Составьте список необходимых логов с уровнем INFO.
Например, изменение статуса заказа. Логируем время, идентификатор покупателя, номер заказа.
Напишите, будете ли вы использовать другие уровни логирования и при каких обстоятельствах

1. Анализ диаграммы, описание логов, которые нужны в системе
   - Internet Shop
   INFO: Пользователь начал оформление заказа.
   INFO: Загрузка 3D-модели пользователем.
   INFO: Заказ отправлен в Shop API.
   ERROR: Ошибка при загрузке файла 3D модели.

   - Shop API
   INFO: Получен новый заказ от Internet Shop.
   INFO: Загрузка 3D файла для заказа ID={orderId}.
   INFO: Заказ ID={orderId} сохранен в БД.
   ERROR: Ошибка сохранения заказа в Shop DB.
   WARN: Загрузка файла не удалась, неверный формат.

   - CRM
   INFO: Пользователь-селлер открыл заказ ID={orderId}.
   INFO: Заказ ID={orderId} подтвержден.
   ERROR: Ошибка загрузки данных заказа.

   - CRM API
   INFO: Получен запрос на подтверждение заказа ID={orderId}.
   INFO: Обновлен статус заказа ID={orderId} на "Подтвержден".
   INFO: Отправлено сообщение в очередь о статусе заказа.
   ERROR: Ошибка при обновлении статуса заказа в БД.

   - 3D Files Storage
   INFO: Получен новый файл для хранения: {filename}.
   INFO: Файл {filename} загружен успешно.
   ERROR: Ошибка при загрузке файла {filename}.

   - Messages Queue
   INFO: Сообщение о новом заказе отправлено в топик {topic}.
   INFO: Сообщение о смене статуса заказа отправлено.
   ERROR: Ошибка публикации сообщения в очередь.

   - MES API
   INFO: Назначение заказа ID={orderId} оператору {operatorId}.
   INFO: Расчет стоимости заказа ID={orderId}.
   INFO: Получен список заказов.
   ERROR: Ошибка назначения заказа оператору.

   - MES (React, TypeScript)
   INFO: Оператор {operatorId} открыл заказ ID={orderId}.
   INFO: Заказ ID={orderId} выполнен.
   ERROR: Ошибка при получении данных заказа.

   - MES DB (PostgreSQL)
   WARN: Запрос с аномально долгим временем выполнения.
   ERROR: Конфликт транзакции при обновлении статуса заказа.

2. Мотивация

   - Обнаружение и устранение ошибок
   - Аудит и трассировка действий пользователей
   - Мониторинг состояния системы
   - Повышение безопасности
   - Упрощение масштабирования и поддержки

3. Предлагаемое решение

[Предполагаемое решение](Предлагаемое_решение.drawio)

Инструменты, которые будут использоваться, это ELK stack

Политика безопасности логов

- Пароли, email, персональные данные (PII) должны не попадать в лог.
- Только системные администраторы и DevOps имеют доступ к log-хранилищу.
- Разработчики — только к логам уровня INFO/DEBUG, без чувствительных данных.
- Доступ в Kibana — через SSO/LDAP.

Политика хранения логов

  - Создаётся отдельный индекс на каждый микросервис или логический блок.

  - Срок хранения
  Ошибки и предупреждения (ERROR, WARN): 90 дней.
  Обычные логи (INFO, DEBUG): 30 дней или 15 в зависимости от объёма.

    - Ограничения по объёму
    Elasticsearch индекс с rollover:
    Предел по объёму: например, 5 ГБ или 1 млн документов.
    После достижения — создаётся новый индекс.

4. Алертинг

Алертинг - ключевая вещь в наблюдаемости.

В Elastik можно задать условие, если пишется больше какого то определенного количество записей логов в минуту
Нужно собрать статистику за какой либо период, вычислить среднее количество запросов в минуту, и отталкиваться от этого показателя.
если значение сильно отличается (несколько десятков или сот раз, значит это аномалия).